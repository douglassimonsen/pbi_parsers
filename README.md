Based on https://timothya.com/pdfs/crafting-interpreters.pdf